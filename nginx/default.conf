    rm royalviewmx.conf
    mv example royalviewmx.conf



    server {
    ## CPANEL CONFIGURATION
    server_name royalview.mx www.royalview.mx mail.royalview.mx 207.210.229.231;
    listen 80;
    listen [::]:80;

    include conf.d/includes-optional/cloudflare.conf;

    set $CPANEL_APACHE_PROXY_PASS $scheme://apache_backend_${scheme}_207_210_229_231;

    # For includes:
    set $CPANEL_APACHE_PROXY_IP 207.210.229.231;
    set $CPANEL_APACHE_PROXY_SSL_IP 207.210.229.231;
    set $CPANEL_SERVICE_SUBDOMAIN 0;

    listen 443 ssl;
    listen [::]:443 ssl;

    ssl_certificate /var/cpanel/ssl/apache_tls/royalview.mx/combined;

    ssl_certificate_key /var/cpanel/ssl/apache_tls/royalview.mx/combined;

    ssl_protocols TLSv1.2 TLSv1.3;
    proxy_ssl_protocols TLSv1.2 TLSv1.3;
    ssl_prefer_server_ciphers on;
    ssl_ciphers ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-A$
    proxy_ssl_ciphers ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE$

  location /cpanelwebcall {
        include conf.d/includes-optional/cpanel-proxy.conf;
        proxy_pass http://127.0.0.1:2082/cpanelwebcall;
    }

    location /Microsoft-Server-ActiveSync {
        include conf.d/includes-optional/cpanel-proxy.conf;
        proxy_pass http://127.0.0.1:2090/Microsoft-Server-ActiveSync;
    }

    
    include conf.d/server-includes/*.conf;
    include conf.d/users/royalviewmx/*.conf;
    include conf.d/users/royalviewmx/royalview.mx/*.conf;

    ## END CPANEL CONFIGURATION

    root /app/royalview.mx;
    gzip on;
    gzip_proxied any;
    gzip_comp_level 4;
    gzip_types text/css application/javascript image/svg+xml;

    # Serve any static assets with NGINX
    location /_next/static {
        alias /app/royalview.mx/.next/static;
        add_header Cache-Control "public, max-age=3600, immutable";
    }

    location / {
        try_files $uri.html $uri/index.html # only serve html files from this dir
        @public
        @nextjs;
        add_header Cache-Control "public, max-age=3600";

        rewrite /departamentos-en-venta-queretaro / permanent;
        rewrite /departamentos-en-venta-Queretaro / permanent;
        rewrite /real-estate-mexico / permanent;
        rewrite /galeria / permanent;
        rewrite /home/modelos /modelos permanent;
    }

    location @public {
        add_header Cache-Control "public, max-age=3600";
    }

    location @nextjs {
        # reverse proxy for next server
        proxy_pass http://localhost:3001; #Don't forget to update your port number
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}



server {
    listen 80;
    listen [::]:80;

    listen 443 ssl;
    listen [::]:443 ssl;

    ssl_certificate /var/cpanel/ssl/apache_tls/royalview.mx/combined;
    ssl_certificate_key /var/cpanel/ssl/apache_tls/royalview.mx/combined;

    server_name  cpanel.royalview.mx cpcalendars.royalview.mx cpcontacts.royalview.mx webdisk.royalview.mx webmail.royalview.mx;

    include conf.d/includes-optional/cloudflare.conf;

    set $CPANEL_APACHE_PROXY_PASS $scheme://apache_backend_${scheme}_207_210_229_231;

    # For includes:
    set $CPANEL_APACHE_PROXY_IP 207.210.229.231;
    set $CPANEL_APACHE_PROXY_SSL_IP 207.210.229.231;
    set $CPANEL_SERVICE_SUBDOMAIN 1;

    location /.well-known/cpanel-dcv {
        root /home/royalviewmx/public_html;
        disable_symlinks if_not_owner;
    }

    location /.well-known/pki-validation {
        root /home/royalviewmx/public_html;
        disable_symlinks if_not_owner;
    }

    location /.well-known/acme-challenge {
        root /home/royalviewmx/public_html;
        disable_symlinks if_not_owner;
    }

    location / {
        # Force https for service subdomains
        if ($scheme = http) {
            return 301 https://$host$request_uri;
        }

        # no cache
        proxy_cache off;
        proxy_no_cache 1;
        proxy_cache_bypass 1;

        # pass to Apache
        include conf.d/includes-optional/cpanel-proxy.conf;
        proxy_pass $CPANEL_APACHE_PROXY_PASS;
    }
}